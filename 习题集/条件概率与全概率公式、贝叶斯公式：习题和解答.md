# 条件概率、全概率公式、贝叶斯公式

符号约定： $P(A|B)=\frac{P(AB)}{P(B)}$ ，全概率 $P(B)=\sum_i P(B|H_i)P(H_i)$，贝叶斯 $P(H_i|B)=\frac{P(B|H_i)P(H_i)}{\sum_j P(B|H_j)P(H_j)}$。

---

## 1）单次医学筛查（贝叶斯）

**已知**：患病率 $1\%(=0.01)$；灵敏度 $0.95$；特异度 $0.98$。求阳性时患病的概率（PPV）。

$$
P(+)=0.01\cdot0.95+0.99\cdot(1-0.98)=0.019+0.0196=0.0386
$$

$$
P(\text{病}|+)=\frac{0.01\cdot0.95}{0.0386}\approx \boxed{0.4922}
$$

（约 49.22%）

---

## 2）两次独立复检（贝叶斯 + 全概率）

**已知**：患病率 $0.01$。初筛：灵敏度 0.90、特异度 0.95；复检：灵敏度 0.95、特异度 0.99。假设在给定疾病状态下两次测试**条件独立**。两次都阳性时患病概率？

* 先用“赔率-似然比”更快：
  - 先验赔率 $=0.01/0.99=0.010101$ 。
  - 初筛阳性 $LR^+=0.90/0.05=18$ 。
  - 复检阳性 $LR^+=0.95/0.01=95$ 。
  - 后验赔率 $=0.010101\times18\times95=17.31$ 。
  - 后验概率 $=\frac{17.31}{1+17.31}\approx \boxed{0.945}$ 。

---

## 3）掷两枚公平骰子（条件概率）

设事件 $A=\{\text{点数和为 }7\}$，条件为“第一枚骰子为 4”。

$$
P(A| \text{首枚 }4)=P(\text{第二枚为 }3)=\boxed{\tfrac16}
$$

---

## 4）迟到与天气（全概率 + 逆向贝叶斯）

**已知**： $P(\text{雨})=0.3$ ， $P(\text{迟到}|\text{雨})=0.4$ ， $P(\text{迟到}|\text{不雨})=0.1$ 。
(1)  $P(\text{迟到})=0.3\cdot0.4+0.7\cdot0.1= \boxed{0.19}$ 。
(2)  $P(\text{雨}|\text{迟到})=\frac{0.3\cdot0.4}{0.19}\approx \boxed{0.6316}$ 。

---

## 5）三种可能的坛子（贝叶斯 + 预测）

随机等概率选一只坛子：

* $U_1$: 2红1蓝； $U_2$ : 1红2蓝； $U_3$ : 3红0蓝。
  抽到一球为**红**（不放回）。求：

1. 三坛子的后验概率；2) 下一球是红的概率。

* 似然： $P(R|U_1)=2/3,\;P(R|U_2)=1/3,\;P(R|U_3)=1$ 。
* 后验（按比例 $2/9:1/9:1/3$ ，归一化和为 $2/3$ ）：

$$
P(U_1|R)=\tfrac13,\quad P(U_2|R)=\tfrac16,\quad P(U_3|R)=\tfrac12.
$$

* 不放回后的下一球红的条件概率：
  $U_1:1/2,\;U_2:0,\;U_3:1$。

$$
P(\text{next }R|R)=\tfrac13\cdot\tfrac12+\tfrac16\cdot0+\tfrac12\cdot1=\boxed{\tfrac23}.
$$

---

## 6）垃圾邮件过滤（贝叶斯）

**已知**： $P(\text{Spam})=0.2$ ；出现词 “free” 的概率 $P(F|\text{Spam})=0.6$ ， $P(F|\text{非 Spam})=0.1$ 。

$$
P(\text{Spam}|F)=\frac{0.2\cdot0.6}{0.2\cdot0.6+0.8\cdot0.1}=\frac{0.12}{0.20}=\boxed{0.6}.
$$

---

## 7）蒙提霍尔问题（条件概率 / 贝叶斯表述）

选 1 扇门，主持人打开另一扇有羊的门并允许你换。求**换门**获车的概率。
用贝叶斯：初始选中车的先验 $1/3$ ；若先选错（ $2/3$ ），主持人必定打开唯一一扇羊门，**换门必中**。

$$
P(\text{换门中})=\boxed{\tfrac23},\quad P(\text{不换中})=\tfrac13.
$$

---

## 8）两工厂与次品（全概率 + 贝叶斯）

**已知**：工厂 A 占 30%，次品率 5%；工厂 B 占 70%，次品率 2% 。
(1) 随机拿一件是次品的概率

$P(D)=0.3\cdot0.05+0.7\cdot0.02=0.029$


(2) 已知是次品，来自 A 的概率

$P(A|D)=\frac{0.3\cdot0.05}{0.029}=\boxed{0.5172}$


---

## 9）硬币是“公平或偏置”的后验与预测（贝叶斯）

随机等概率选一枚硬币：

* 公平 $H_f:p=0.5$；偏置 $H_b:p=0.7$。
  独立抛 3 次结果为 HHT（或 3 次均为正面，任意具体序列含 2 或 3 个正面都可用同法；这里用 **3 次均正面** 更直观）。
  取 **3 次均正面**：

$$
P(\text{HHH}|H_f)=0.5^3=0.125,\quad P(\text{HHH}|H_b)=0.7^3=0.343.
$$

$$
P(H_b|\text{HHH})=\frac{0.343\cdot0.5}{0.343\cdot0.5+0.125\cdot0.5}=\frac{0.343}{0.343+0.125}\approx \boxed{0.732}.
$$

下一次为正面的预测概率

$$
P(\text{next H}|\text{HHH})=0.732\cdot0.7+(1-0.732)\cdot0.5\approx \boxed{0.646}.
$$

---

## 10）几何条件概率（连续型）

在单位正方形 $[0,1]^2$ 上均匀取点 $(X,Y)$。求

$$
P\big(X<0.25\ \big|\ X<Y\big).
$$

* 条件区域 $X<Y$ 为对角线上方三角形，面积 $1/2$。
* 同时满足 $X<0.25$ 的子区域面积

$$
\int_{0}^{0.25} (1-x)\,dx= \Big[x-\tfrac{x^2}{2}\Big]_0^{0.25}=0.25-0.03125=0.21875.
$$

故

$$
P=\frac{0.21875}{0.5}= \boxed{0.4375}.
$$

---

这些题覆盖了**条件概率的直接计算、全概率分解、多假设贝叶斯更新、预测概率**等常见考点。
