

# 🎯 一、双因素 ANOVA 的总体思想

双因素 ANOVA 用于分解总变异（Total Variation）为：

1. **因素 A 的变异（主效应）**
2. **因素 B 的变异（主效应）**
3. **A × B 交互作用的变异**
4. **随机误差变异（组内误差）**

数学分解为：

$$
SS_{Total} = SS_A + SS_B + SS_{AB} + SS_E
$$

---

# 🎯 二、实验结构

假设双因素布局如下：

* 因素 A 有 (a) 个水平
* 因素 B 有 (b) 个水平
* 每个组合重复 (n) 次（平衡设计）
* 总观测数 (N = abn)

记号：

* $(Y_{ijk})$：A 的第 i 水平、B 的第 j 水平、第 k 个重复的观测
* (\bar{Y}_{ij\cdot})：A=i, B=j 组合的平均数
* (\bar{Y}_{i\cdot\cdot})：A=i 的组均值
* (\bar{Y}_{\cdot j\cdot})：B=j 的组均值
* (\bar{Y}_{\cdot\cdot\cdot})：总体平均数

---

# 🎯 三、平方和（Sum of Squares, SS）的计算公式

---

## **1️⃣ 总平方和（Total SS）**

$$
SS_{Total}=\sum_{i=1}^{a}\sum_{j=1}^{b}\sum_{k=1}^{n}
(Y_{ijk}-\bar{Y}_{\cdot\cdot\cdot})^2
$$

---

## **2️⃣ 因素 A 的平方和（主效应 A）**

$$
SS_A=bn \sum_{i=1}^{a}(\bar{Y}*{i\cdot\cdot}-\bar{Y}*{\cdot\cdot\cdot})^2
$$

解释：

* 看不同**肥料种类（A）**之间均值是否差异大
* “bn”表示每个 A 水平包含 b×n 个观测

---

## **3️⃣ 因素 B 的平方和（主效应 B）**

$$
SS_B=an \sum_{j=1}^{b}(\bar{Y}*{\cdot j\cdot}-\bar{Y}*{\cdot\cdot\cdot})^2
$$

解释：

* 看不同**灌溉方式（B）**是否导致产量差异
* “an”表示每个 B 水平包含 a×n 个观测

---

## **4️⃣ 交互作用平方和（A×B）**

$$
SS_{AB}=n \sum_{i=1}^{a}\sum_{j=1}^{b}
(\bar{Y}*{ij\cdot}-\bar{Y}*{i\cdot\cdot}-\bar{Y}*{\cdot j\cdot}+\bar{Y}*{\cdot\cdot\cdot})^2
$$

解释：

* 检测**肥料效果是否因灌溉不同而改变**
* 若 (\bar{Y}_{ij\cdot}) 不能由 A 与 B 的主效应相加解释，则说明存在交互作用

---

## **5️⃣ 误差平方和（Error SS）**

$$
SS_E=\sum_{i=1}^{a}\sum_{j=1}^{b}\sum_{k=1}^{n}
(Y_{ijk}-\bar{Y}_{ij\cdot})^2
$$

解释：

* 同一“肥料+灌溉”组合内部由于随机波动造成的变异
* 这是检验 A、B、交互作用的基准

---

# 🎯 四、均方（MS）与自由度（df）

| 变异来源    | SS           | df           | MS = SS/df                           |
| ------- | ------------ | ------------ | ------------------------------------ |
| 因素 A    | (SS_A)       | (a-1)        | (MS_A=\frac{SS_A}{a-1})              |
| 因素 B    | (SS_B)       | (b-1)        | (MS_B=\frac{SS_B}{b-1})              |
| 交互作用 AB | (SS_{AB})    | ((a-1)(b-1)) | (MS_{AB}=\frac{SS_{AB}}{(a-1)(b-1)}) |
| 误差 E    | (SS_E)       | (ab(n-1))    | (MS_E=\frac{SS_E}{ab(n-1)})          |
| 总体      | (SS_{Total}) | (N-1)        | —                                    |

---

# 🎯 五、F 统计量（检验显著性）

### **主效应 A：**

$$
F_A = \frac{MS_A}{MS_E}
$$

检验：

> 不同肥料类型是否导致显著不同产量？

---

### **主效应 B：**

$$
F_B = \frac{MS_B}{MS_E}
$$

检验：

> 不同灌溉方式是否导致显著差异？

---

### **交互作用 AB：**

$$
F_{AB} = \frac{MS_{AB}}{MS_E}
$$

检验：

> 肥料的效果是否因灌溉方式不同而改变？

这是双因素 ANOVA 的核心。

---

# 🎯 六、基本原理：为什么这样做？

双因素 ANOVA 的原理来自 **方差分解（ANOVA decomposition）**：

> **如果某个因素真的有影响，那么它对应的“组间均值差异”会比“组内随机波动”更大。**

具体来说：

* (MS_A) 大 → 说明不同肥料水平间的均值差异大
* (MS_B) 大 → 灌溉方式差异显著
* (MS_{AB}) 大 → 不同肥料在不同灌溉方式下“表现不一致”，即存在交互
* 通过比较 **组间 MS / 误差 MS** 得到 F 值

若 F 值大，则 p 小 → 拒绝零假设，说明该因素显著。

---

# 🎯 七、交互作用的统计含义（关键）

$$
\text{无交互时： } \bar{Y}_{ij\cdot} = \text{A效应} + \text{B效应}
$$

若观察值偏离上述加法模型：

→ 模型误差大 → (SS_{AB}) 大 → 交互作用显著。

这意味着：

> **某种肥料的效果依赖于灌溉方式（乘法效应，而不是加法）。**

这就是双因素 ANOVA 的核心价值。

---

# 🎯 八、总结一句话

> **双因素 ANOVA 的本质是：把总变异分解成 A、B、AB（交互）和误差四部分，
> 再用 MS(因素)/MS(误差) 形成 F 统计量进行假设检验。**

---


