
## 1️⃣ 场景设定：三种肥料的比较

研究者想比较三种肥料对小麦产量的影响：A、B、C，每种肥料随机施在 5 块地里（单位：kg）。

**数据假设如下：**

* 肥料 A：
  42, 45, 40, 43, 44 → 平均 ≈ **42.8**
* 肥料 B：
  50, 52, 49, 51, 53 → 平均 ≈ **51.0**
* 肥料 C：
  46, 47, 45, 48, 46 → 平均 ≈ **46.4**

肉眼看：
B 组均值 > C 组 > A 组，**但差异是不是“显著”要靠统计检验**。

---

## 2️⃣ 先做单因素方差分析（ANOVA）

**零假设 H₀：** 三种肥料的总体均值相同

$$
\mu_A = \mu_B = \mu_C
$$

把数据丢进软件（SPSS、R、Python 都行），ANOVA 结果假设是：

* F = 15.2
* p = 0.0005 < 0.05 → **拒绝 H₀**

**解释：**
至少有一种肥料的均值和其他不一样，但**不知道是哪些在差**，这时就需要**多重比较（事后检验）**。

---

## 3️⃣ 为什么不能直接做很多 t 检验？

三组要比较的两两组合有：

* A vs B
* A vs C
* B vs C

一共 **3 个**比较。

如果每次都用 α = 0.05 做 t 检验，那么：
**“至少错判一次”的概率 > 0.05**，大约是：

$$
P(\text{至少一对错判}) = 1 - (1-0.05)^3 \approx 0.14
$$

也就是**系列比较的整体犯Ⅰ类错误率（家族错误率）≈ 14%**，远大于 5%。
**多重比较的目的，就是“控制整体错误率”。**

---

## 4️⃣ 用 Bonferroni 校正举例（最简单好懂）

Bonferroni 思路很粗暴，但好理解：

> 把总体显著性水平 α 均分到每一次比较上。

这里有 3 个两两比较，设总体 α = 0.05，则每一对比较使用：

$$
\alpha^* = \frac{0.05}{3} \approx 0.0167
$$

接下来对三对做 t 检验（或软件直接输出 pairwise comparison），假设得到的 **p 值如下**：

* A vs B：p = 0.0008
* A vs C：p = 0.0200
* B vs C：p = 0.0300

### 用 Bonferroni 判断

每个比较用 **α* = 0.0167** 作为阈值：

1. **A vs B：p = 0.0008 < 0.0167 → 显著差异 ✅**
2. **A vs C：p = 0.0200 > 0.0167 → 不显著 ❌**
3. **B vs C：p = 0.0300 > 0.0167 → 不显著 ❌**

> 即使 A–C、B–C 看起来“有点差”，为了整体错误率不过高，**我们选择“宁可保守一点”**，只承认 A 与 B 的差异显著。

**结论：**

* 肥料 B 的产量显著高于 A
* A 和 C 的差异不显著
* B 和 C 的差异也不显著

实务中一般会给出均值和显著性：

| 组别 | 平均产量 | 结论（和其他组比较）        |
| -- | ---- | ----------------- |
| A  | 42.8 | 显著低于 B，与 C 无显著差异  |
| B  | 51.0 | 显著高于 A，与 C 无显著差异  |
| C  | 46.4 | 介于 A、B 之间，与两者均不显著 |

---

## 5️⃣ 另一类方法：Tukey HSD（只简单提一下）

在方差齐性、样本量相近时，常用 **Tukey HSD**：

* 直接比较各组均值差
* 用一个统一的“最小显著差”（HSD）作为门槛
* 优点：对所有两两比较，**家族错误率控制在 α**，比一堆 t 检验更规范
* 软件通常可直接输出：哪几组差异显著，用字母标记（如 A 组=“a”，B 组=“b”，C 组=“ab” 等）

---

## 6️⃣ 小结一句话版

1. **ANOVA 告诉你：是否“有组不一样”**
2. **多重比较告诉你：具体“谁和谁不一样”**
3. **多重比较的关键点：控制整体犯错率（家族错误率），不能随便做一堆 t 检验。**



