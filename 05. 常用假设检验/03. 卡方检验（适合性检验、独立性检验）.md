


# 卡方检验（Chi-square Test）

---

## 一、基本概念（Concept）

* **卡方检验 (Chi-square Test, χ² Test)**：用于检验**分类变量 (Categorical Variables)** 的分布特征或相关性。
* **核心思想**：比较**实际观测频数 (Observed Frequency, $O$)** 与**理论期望频数 (Expected Frequency, $E$)** 之间的差异。

---

## 二、统计量公式（Test Statistic）

$$
\chi^2 = \sum \frac{(O_i - E_i)^2}{E_i}
$$

* $O_i$ ：观测频数 (Observed frequency)。
* $E_i$ ：期望频数 (Expected frequency)。
* 自由度 (Degrees of Freedom, df)：与检验类型有关。

当 $\chi^2$ 值较大 → 说明差异显著 → 拒绝原假设。

---

## 三、卡方适合性检验（Chi-square Goodness-of-fit Test）

### 1. 目的

检验某**分类变量的实际分布**是否与**理论分布**一致。

### 2. 假设

* $H_0$ ：样本数据服从理论分布。
* $H_1$ ：样本数据不服从理论分布。

### 3. 自由度

$$
df = k - 1 - m
$$

其中 $k$ = 分类数， $m$ = 已估计参数个数。

### 4. 应用场景

* 骰子是否均匀。
* 学生成绩等级分布是否符合预期比例。

---

## 四、卡方独立性检验（Chi-square Test of Independence）

### 1. 目的

检验两个**分类变量**之间是否独立。

### 2. 假设

* $H_0$ ：两个变量相互独立。
* $H_1$ ：两个变量不独立。

### 3. 方法

* 构建 **列联表 (Contingency Table)**。
* 计算每个单元格的期望频数：

$$
E_{ij} = \frac{(\text{行合计})(\text{列合计})}{\text{总样本数}}
$$

### 4. 自由度

$$
df = (r-1)(c-1)
$$

其中 $r$ =行数， $c$ =列数。

### 5. 应用场景

* 性别与是否吸烟是否独立。
* 教育水平与职业类别是否独立。

---

## 五、注意事项（Notes）

* 样本量要足够大（通常要求每个期望频数 $E_i \geq 5$ ）。
* 卡方检验只说明是否存在差异或关联，不说明差异大小或方向。

---

## 六、知识结构总结

```
卡方检验 (Chi-square Test)
   ├─ 适合性检验 (Goodness-of-fit)
   │    → 检验样本分布与理论分布是否一致
   │    → df = k - 1 - m
   └─ 独立性检验 (Test of Independence)
        → 检验两个分类变量是否独立
        → df = (r-1)(c-1)
统计量：χ² = Σ (O - E)² / E
```

---

✅ **总结**：

* **卡方适合性检验 (Goodness-of-fit Test)** → 验证观测数据是否符合理论分布。
* **卡方独立性检验 (Test of Independence)** → 检验两个分类变量是否独立。
* **核心统计量**：$\chi^2 = \sum (O-E)^2/E$，越大说明差异越显著。
* **局限性**：对样本量和期望频数敏感，只能说明“是否显著”，不能说明“相关强度”。

---


