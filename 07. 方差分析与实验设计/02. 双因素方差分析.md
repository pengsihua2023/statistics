

# 双因素方差分析（Two-way Analysis of Variance, Two-way ANOVA）

---

## 一、基本概念（Concept）

* **双因素方差分析 (Two-way ANOVA)**：用于研究 **两个因素 (Two Factors)** 对因变量 (Dependent Variable) 的影响，以及两因素间是否存在**交互作用 (Interaction Effect)**。
* 相比单因素 ANOVA，双因素 ANOVA 能同时考察：

  1. 各单独因素的主效应 (Main Effect)。
  2. 两个因素的交互效应 (Interaction Effect)。

---

## 二、基本假设（Assumptions）

1. **独立性 (Independence)**：各组样本独立。
2. **正态性 (Normality)**：各处理组合数据近似正态分布。
3. **方差齐性 (Homogeneity of Variances)**：各组总体方差相等。

---

## 三、假设设定（Hypotheses）

以因素 A 有 $a$ 个水平，因素 B 有 $b$ 个水平为例：

1. **因素 A 的主效应 (Main Effect of Factor A)**

* $H_0^A: \mu_{1\cdot} = \mu_{2\cdot} = \cdots = \mu_{a\cdot}$
* $H_1^A$：至少有一个水平均值不同。

2. **因素 B 的主效应 (Main Effect of Factor B)**

* $H_0^B: \mu_{\cdot1} = \mu_{\cdot2} = \cdots = \mu_{\cdot b}$
* $H_1^B$ ：至少有一个水平均值不同。

3. **交互效应 (Interaction Effect $A \times B$)**

* $H_0^{AB}$ ：因素 A 与 B 之间无交互作用。
* $H_1^{AB}$：存在交互作用。

---

## 四、方差分解（Variance Decomposition）

总平方和分解为：

$$
SST = SSA + SSB + SSAB + SSE
$$

* **SSA**：因素 A 的平方和 (Sum of Squares for Factor A)
* **SSB**：因素 B 的平方和 (Sum of Squares for Factor B)
* **SSAB**：交互作用平方和 (Sum of Squares for Interaction)
* **SSE**：误差平方和 (Error Sum of Squares)

对应均方 (Mean Square)：

$$
MSA = \frac{SSA}{a-1}, \quad MSB = \frac{SSB}{b-1}, \quad MSAB = \frac{SSAB}{(a-1)(b-1)}, \quad MSE = \frac{SSE}{ab(n-1)}
$$

---

## 五、检验统计量（Test Statistics）

* 对每个效应（A、B、交互作用）：

$$
F = \frac{MS_{\text{效应}}}{MSE}
$$

* 分别进行 F 检验，判断是否显著。

---

## 六、结果解释（Interpretation）

1. **若交互效应显著 (Interaction Significant)**：

   * 主效应解释需谨慎，因为因素效应随另一个因素水平不同而变化。
   * 通常绘制 **交互作用图 (Interaction Plot)** 来辅助解释。

2. **若交互效应不显著**：

   * 可直接解释主效应结果。

---

## 七、应用举例（Example）

📍 **例子**：研究“教学方法 (Factor A: 传统 / 互动)” 与 “性别 (Factor B: 男 / 女)” 对“学生成绩 (Dependent Variable)”的影响。

* 主效应：教学方法是否影响成绩？性别是否影响成绩？
* 交互效应：教学方法对成绩的作用是否因性别而异？

---

## 八、知识结构总结

```
双因素方差分析 (Two-way ANOVA)
   ├─ 概念：研究两个因素及交互作用对因变量的影响
   ├─ 假设：
   │    → 因素 A 主效应
   │    → 因素 B 主效应
   │    → 交互效应 A×B
   ├─ 方差分解：SST = SSA + SSB + SSAB + SSE
   ├─ 检验统计量：F = MS_effect / MSE
   ├─ 结果解释：交互作用显著 → 主效应需谨慎解释
   └─ 应用：教育、医学、农业实验等
```

---

✅ **总结**：

* **双因素 ANOVA** 可同时分析两个因素的主效应与交互效应。
* **方差分解**包含主效应平方和与交互作用平方和。
* **结论解释**时要特别注意交互效应的显著性，它决定了主效应的解释方式。

---



